global
    log /dev/log local0
    log /dev/log local1 notice
    daemon
    user haproxy
    group haproxy
    maxconn 2000

defaults
    log global
    mode http
    option httplog
    option dontlognull
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms
    errorfile 503 /etc/haproxy/errors/503.http

listen stats
    bind *:8888
    mode http
    stats enable
    stats uri /stats
    stats refresh 5s
    stats realm Haproxy\ Statistics

frontend example_sites
    bind *:8088
    mode http
    acl host_example1 hdr(host) -i example1.local
    acl host_example2 hdr(host) -i example2.local
    use_backend backend_example1 if host_example1
    use_backend backend_example2 if host_example2
    default_backend no_match

backend backend_example1
    mode http
    balance roundrobin
    option http-server-close
    option forwardfor
    option httpchk GET /index.html
    server s1a 127.0.0.1:8001 check inter 3s fall 2 rise 2
    server s2a 127.0.0.1:8002 check inter 3s fall 2 rise 2

backend backend_example2
    mode http
    balance roundrobin
    option http-server-close
    option forwardfor
    option httpchk GET /index.html
    server s3a 127.0.0.1:9001 check inter 3s fall 2 rise 2
    server s4a 127.0.0.1:9002 check inter 3s fall 2 rise 2

backend no_match
    mode http
    http-request deny deny_status 400
